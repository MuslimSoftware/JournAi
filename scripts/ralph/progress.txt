## Feature: Centralize AI Prompts (Architecture)
**Status: PASSED**
**Date: 2026-01-23**

### Implementation Summary
Created a centralized prompts file at `src/ai/prompts.ts` that exports all AI prompts used in the application:
- CHAT_SYSTEM_PROMPT - Basic chat assistant prompt
- RAG_CHAT_SYSTEM_PROMPT - Chat with journal context prompt
- ENTRY_ANALYSIS_PROMPT - Entry analysis for extracting emotions/people
- CHAT_MODULE_PROMPT - AI agent chat module prompt
- TOOL_ROUTER_PROMPT - AI agent tool router prompt
- TITLE_GENERATION_PROMPT - Chat title generation prompt

Updated all service files to import from the centralized prompts file:
- src/services/ai.ts
- src/services/entryAnalysis.ts
- src/services/chats.ts
- src/ai/modules/chat.ts
- src/ai/modules/toolRouter.ts

### QA Test Results
1. ✅ Locate the new prompts file at src/ai/prompts.ts - File exists
2. ✅ Verify the file exports all AI prompts - 6 prompts exported
3. ✅ Verify chat system prompt is defined - CHAT_SYSTEM_PROMPT, RAG_CHAT_SYSTEM_PROMPT
4. ✅ Verify insights analysis prompt is defined - ENTRY_ANALYSIS_PROMPT
5. ✅ Verify all prompt usages import from this file - All 5 files import correctly
6. ✅ Search codebase for hardcoded prompts - None found outside prompts.ts
7. ✅ Verify no duplicate prompt definitions - All prompts defined only in prompts.ts

### Verification
- TypeScript compilation: PASSED
- Tauri build (debug): PASSED
- App functionality verified via Tauri MCP screenshot - Chat feature working correctly

---

## Feature: Richer Insights Descriptions (Functional)
**Status: PASSED**
**Date: 2026-01-24**

### Implementation Summary
Updated the `ENTRY_ANALYSIS_PROMPT` in `src/ai/prompts.ts` to request more detailed descriptions for emotion triggers and person context fields.

Changes made to the prompt:
1. **Emotion trigger field**: Changed from optional brief description to required 1-2 sentence description explaining:
   - What caused or contributed to the emotion
   - Specific circumstances, events, or thoughts that triggered the feeling
   - Enough context for standalone understanding

2. **Person context field**: Changed from optional brief description to required 1-2 sentence description explaining:
   - The nature of the interaction or mention
   - What happened and why this person was mentioned
   - Relevant circumstances and significance

3. Added explicit instruction that trigger and context fields are required (not optional) and must contain meaningful 1-2 sentence descriptions.

### Technical Changes
- File modified: `src/ai/prompts.ts`
- Updated `ENTRY_ANALYSIS_PROMPT` constant with enhanced field descriptions
- No schema/type changes required (fields were already string type)

### Verification
- TypeScript compilation: PASSED

---

## Feature: Entry Editor Auto-Scroll (UI)
**Status: PASSED**
**Date: 2026-01-24**

### Implementation Summary
Fixed the `scrollCursorIntoView` function in `ContentEditableEditor.tsx` to properly keep the cursor visible while typing long content.

**Root Cause:** The original implementation compared the cursor position against the editor element's bounding rect instead of the scroll parent's visible bounds. Since the editor grows with content inside the scroll container, this comparison was incorrect.

### Technical Changes
1. **src/components/entries/ContentEditableEditor.tsx**
   - Refactored `scrollCursorIntoView` to compare cursor position against the scroll parent's bounds (not the editor's bounds)
   - Added early return for empty cursor rectangles (width/height = 0)
   - Added padding buffer (20px) to scroll before cursor reaches the edge
   - Simplified the scroll logic by finding the scroll parent first

2. **src/styles/mobile.css**
   - Added `overflow-y: auto` to `.mobile-editor-content-wrapper` to enable proper scrolling on mobile

### Files Modified
- `src/components/entries/ContentEditableEditor.tsx`
- `src/styles/mobile.css`

### QA Test Results
1. ✅ Navigate to entry editor
2. ✅ Start typing content that exceeds the visible area
3. ✅ Continue typing past the bottom of the visible text area
4. ✅ View automatically scrolls to keep cursor visible
5. ✅ User does not need to manually scroll to see what they're typing
6. ✅ Type multiple lines rapidly - scroll keeps up
7. ✅ Scroll position keeps up with cursor position
8. ✅ Smooth scrolling behavior without jarring jumps

### Verification
- TypeScript compilation: PASSED
- Manual QA by user: PASSED
